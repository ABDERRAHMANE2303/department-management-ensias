<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1255px" preserveAspectRatio="none" style="width:815px;height:1255px;background:#FFFFFF;" version="1.1" viewBox="0 0 815 1255" width="815px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="42.5938" id="_title" style="stroke:none;stroke-width:1.0;" width="341" x="233.25" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="331" x="238.25" y="27.9951">Authentification JWT avec Refresh Tokens</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="289" x="259.25" y="44.292">Plateforme ENSIAS - Vue d'ensemble</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="42" x2="42" y1="134.8906" y2="1174.4063"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="213" x2="213" y1="134.8906" y2="1174.4063"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="435.5" x2="435.5" y1="134.8906" y2="1174.4063"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="650.5" x2="650.5" y1="134.8906" y2="1174.4063"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="748.5" x2="748.5" y1="134.8906" y2="1174.4063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="5" y="131.5889">Utilisateur</text><ellipse cx="42" cy="67.0938" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M42,75.0938 L42,102.0938 M29,83.0938 L55,83.0938 M42,102.0938 L29,117.0938 M42,102.0938 L55,117.0938 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="5" y="1186.4014">Utilisateur</text><ellipse cx="42" cy="1198.2031" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M42,1206.2031 L42,1233.2031 M29,1214.2031 L55,1214.2031 M42,1233.2031 L29,1248.2031 M42,1233.2031 L55,1248.2031 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#F8F9FA" height="30.2969" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:0.5;" width="88" x="169" y="103.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="176" y="123.5889">Client Web</text><rect fill="#F8F9FA" height="30.2969" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:0.5;" width="88" x="169" y="1173.4063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="176" y="1193.4014">Client Web</text><rect fill="#F8F9FA" height="30.2969" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:0.5;" width="103" x="384.5" y="103.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="391.5" y="123.5889">Serveur Auth</text><rect fill="#F8F9FA" height="30.2969" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:0.5;" width="103" x="384.5" y="1173.4063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="391.5" y="1193.4014">Serveur Auth</text><rect fill="#F8F9FA" height="30.2969" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:0.5;" width="35" x="633.5" y="103.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21" x="640.5" y="123.5889">API</text><rect fill="#F8F9FA" height="30.2969" rx="2.5" ry="2.5" style="stroke:#3498DB;stroke-width:0.5;" width="35" x="633.5" y="1173.4063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21" x="640.5" y="1193.4014">API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="694.5" y="131.5889">Base Données</text><path d="M731,82.5938 C731,72.5938 749,72.5938 749,72.5938 C749,72.5938 767,72.5938 767,82.5938 L767,108.5938 C767,118.5938 749,118.5938 749,118.5938 C749,118.5938 731,118.5938 731,108.5938 L731,82.5938 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M731,82.5938 C731,92.5938 749,92.5938 749,92.5938 C749,92.5938 767,92.5938 767,82.5938 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="694.5" y="1186.4014">Base Données</text><path d="M731,1199.7031 C731,1189.7031 749,1189.7031 749,1189.7031 C749,1189.7031 767,1189.7031 767,1199.7031 L767,1225.7031 C767,1235.7031 749,1235.7031 749,1235.7031 C749,1235.7031 731,1235.7031 731,1225.7031 L731,1199.7031 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M731,1199.7031 C731,1209.7031 749,1209.7031 749,1209.7031 C749,1209.7031 767,1209.7031 767,1199.7031 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="808.5" x="0" y="165.457"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="808.5" y1="165.457" y2="165.457"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="808.5" y1="168.457" y2="168.457"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="114" x="347.25" y="154.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="95" x="353.25" y="170.9575">1. Connexion</text><polygon fill="#181818" points="201,205.1563,211,209.1563,201,213.1563,205,209.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42" x2="207" y1="209.1563" y2="209.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="49" y="204.0903">Login (email/password)</text><polygon fill="#181818" points="424,234.2891,434,238.2891,424,242.2891,428,238.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="213" x2="430" y1="238.2891" y2="238.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="220" y="233.2231">POST /auth/login</text><polygon fill="#181818" points="737,263.4219,747,267.4219,737,271.4219,741,267.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="436" x2="743" y1="267.4219" y2="267.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="443" y="262.356">Vérifier utilisateur</text><line style="stroke:#181818;stroke-width:1.0;" x1="436" x2="478" y1="311.6875" y2="311.6875"/><line style="stroke:#181818;stroke-width:1.0;" x1="478" x2="478" y1="311.6875" y2="324.6875"/><line style="stroke:#181818;stroke-width:1.0;" x1="437" x2="478" y1="324.6875" y2="324.6875"/><polygon fill="#181818" points="447,320.6875,437,324.6875,447,328.6875,443,324.6875" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="443" y="291.4888">Générer Access Token (15 min)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="443" y="306.6216">+ Refresh Token (7 jours)</text><polygon fill="#181818" points="224,349.8203,214,353.8203,224,357.8203,220,353.8203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="218" x2="435" y1="353.8203" y2="353.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="230" y="348.7544">{access_token, refresh_token}</text><polygon fill="#181818" points="53,378.9531,43,382.9531,53,386.9531,49,382.9531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="47" x2="212" y1="382.9531" y2="382.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="59" y="377.8872">Connexion réussie</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="808.5" x="0" y="411.5195"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="808.5" y1="411.5195" y2="411.5195"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="808.5" y1="414.5195" y2="414.5195"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="167" x="320.75" y="400.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="148" x="326.75" y="417.02">2. Requête Normale</text><polygon fill="#181818" points="201,451.2188,211,455.2188,201,459.2188,205,455.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42" x2="207" y1="455.2188" y2="455.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="49" y="450.1528">Accéder aux données</text><polygon fill="#181818" points="639,495.4844,649,499.4844,639,503.4844,643,499.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="213" x2="645" y1="499.4844" y2="499.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="220" y="479.2856">GET /api/data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="220" y="494.4185">Bearer: access_token</text><line style="stroke:#181818;stroke-width:1.0;" x1="651" x2="693" y1="528.6172" y2="528.6172"/><line style="stroke:#181818;stroke-width:1.0;" x1="693" x2="693" y1="528.6172" y2="541.6172"/><line style="stroke:#181818;stroke-width:1.0;" x1="652" x2="693" y1="541.6172" y2="541.6172"/><polygon fill="#181818" points="662,537.6172,652,541.6172,662,545.6172,658,541.6172" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="658" y="523.5513">Valider token</text><polygon fill="#181818" points="224,566.75,214,570.75,224,574.75,220,570.75" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="218" x2="650" y1="570.75" y2="570.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="230" y="565.6841">Données demandées</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="808.5" x="0" y="599.3164"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="808.5" y1="599.3164" y2="599.3164"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="808.5" y1="602.3164" y2="602.3164"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="266" x="271.25" y="588.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="247" x="277.25" y="604.8169">3. Token Expiré - Renouvellement</text><polygon fill="#181818" points="639,639.0156,649,643.0156,639,647.0156,643,643.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="213" x2="645" y1="643.0156" y2="643.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170" x="220" y="637.9497">Requête avec token expiré</text><polygon fill="#181818" points="224,668.1484,214,672.1484,224,676.1484,220,672.1484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="218" x2="650" y1="672.1484" y2="672.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="230" y="667.0825">401 - Token expiré</text><polygon fill="#181818" points="424,712.4141,434,716.4141,424,720.4141,428,716.4141" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="213" x2="430" y1="716.4141" y2="716.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="220" y="696.2153">POST /auth/refresh</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="220" y="711.3481">{refresh_token}</text><line style="stroke:#181818;stroke-width:1.0;" x1="436" x2="478" y1="745.5469" y2="745.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="478" x2="478" y1="745.5469" y2="758.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="437" x2="478" y1="758.5469" y2="758.5469"/><polygon fill="#181818" points="447,754.5469,437,758.5469,447,762.5469,443,758.5469" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="443" y="740.481">Valider refresh token</text><polygon fill="#181818" points="224,783.6797,214,787.6797,224,791.6797,220,787.6797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="218" x2="435" y1="787.6797" y2="787.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="230" y="782.6138">Nouveau access_token</text><polygon fill="#181818" points="639,812.8125,649,816.8125,639,820.8125,643,816.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="213" x2="645" y1="816.8125" y2="816.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242" x="220" y="811.7466">Nouvelle requête avec nouveau token</text><polygon fill="#181818" points="224,841.9453,214,845.9453,224,849.9453,220,845.9453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="218" x2="650" y1="845.9453" y2="845.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="230" y="840.8794">Données demandées</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="808.5" x="0" y="874.5117"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="808.5" y1="874.5117" y2="874.5117"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="808.5" y1="877.5117" y2="877.5117"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="132" x="338.25" y="863.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="113" x="344.25" y="880.0122">4. Déconnexion</text><polygon fill="#181818" points="201,914.2109,211,918.2109,201,922.2109,205,918.2109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="42" x2="207" y1="918.2109" y2="918.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="49" y="913.145">Logout</text><polygon fill="#181818" points="424,943.3438,434,947.3438,424,951.3438,428,947.3438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="213" x2="430" y1="947.3438" y2="947.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="220" y="942.2778">POST /auth/logout</text><line style="stroke:#181818;stroke-width:1.0;" x1="436" x2="478" y1="976.4766" y2="976.4766"/><line style="stroke:#181818;stroke-width:1.0;" x1="478" x2="478" y1="976.4766" y2="989.4766"/><line style="stroke:#181818;stroke-width:1.0;" x1="437" x2="478" y1="989.4766" y2="989.4766"/><polygon fill="#181818" points="447,985.4766,437,989.4766,447,993.4766,443,989.4766" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="443" y="971.4106">Invalider refresh token</text><line style="stroke:#181818;stroke-width:1.0;" x1="213" x2="255" y1="1018.6094" y2="1018.6094"/><line style="stroke:#181818;stroke-width:1.0;" x1="255" x2="255" y1="1018.6094" y2="1031.6094"/><line style="stroke:#181818;stroke-width:1.0;" x1="214" x2="255" y1="1031.6094" y2="1031.6094"/><polygon fill="#181818" points="224,1027.6094,214,1031.6094,224,1035.6094,220,1031.6094" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="220" y="1013.5435">Supprimer tokens</text><polygon fill="#181818" points="53,1056.7422,43,1060.7422,53,1064.7422,49,1060.7422" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="47" x2="212" y1="1060.7422" y2="1060.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="59" y="1055.6763">Déconnecté</text><path d="M441,1073.7422 L441,1158.7422 L658,1158.7422 L658,1083.7422 L648,1073.7422 L441,1073.7422 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M648,1073.7422 L648,1083.7422 L658,1083.7422 L648,1073.7422 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="65" x="447" y="1090.8091">Sécurité:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="447" y="1105.9419">• Access token courte durée</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="447" y="1121.0747">• Refresh token longue durée</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="447" y="1136.2075">• Renouvellement transparent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196" x="447" y="1151.3403">• Invalidation à la déconnexion</text><!--MD5=[c12c077cd4dc40b212345368cd999830]
@startuml
skinparam backgroundColor white
skinparam participant {
    BackgroundColor #f8f9fa
    BorderColor #3498db
}

title Authentification JWT avec Refresh Tokens\nPlateforme ENSIAS - Vue d'ensemble

actor Utilisateur as User
participant "Client Web" as Client
participant "Serveur Auth" as Auth
participant "API" as API
database "Base Données" as DB

== 1. Connexion ==
User -> Client : Login (email/password)
Client -> Auth : POST /auth/login
Auth -> DB : Vérifier utilisateur
Auth -> Auth : Générer Access Token (15 min)\n+ Refresh Token (7 jours)
Auth - -> Client : {access_token, refresh_token}
Client - -> User : Connexion réussie

== 2. Requête Normale ==
User -> Client : Accéder aux données
Client -> API : GET /api/data\nBearer: access_token
API -> API : Valider token
API - -> Client : Données demandées

== 3. Token Expiré - Renouvellement ==
Client -> API : Requête avec token expiré
API - -> Client : 401 - Token expiré
Client -> Auth : POST /auth/refresh\n{refresh_token}
Auth -> Auth : Valider refresh token
Auth - -> Client : Nouveau access_token
Client -> API : Nouvelle requête avec nouveau token
API - -> Client : Données demandées

== 4. Déconnexion ==
User -> Client : Logout
Client -> Auth : POST /auth/logout
Auth -> Auth : Invalider refresh token
Client -> Client : Supprimer tokens
Client - -> User : Déconnecté

note right of Auth
  **Sécurité:**
  • Access token courte durée
  • Refresh token longue durée
  • Renouvellement transparent
  • Invalidation à la déconnexion
end note
@enduml

PlantUML version 1.2022.7(Mon Aug 22 17:01:30 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>